{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-12T17:13:09.351365Z", "invocation_id": "ee6e5a77-04a9-491a-b476-ab30f93ae528", "invocation_started_at": "2025-11-12T17:12:33.034636Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-12T17:12:47.854604Z", "completed_at": "2025-11-12T17:12:47.876618Z"}, {"name": "execute", "started_at": "2025-11-12T17:12:47.907757Z", "completed_at": "2025-11-12T17:12:52.602336Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 4.792554140090942, "adapter_response": {"_message": "CREATE TABLE (100.0 rows, 14.2 KiB processed)", "code": "CREATE TABLE", "rows_affected": 100, "bytes_processed": 14547, "bytes_billed": 10485760, "location": "EU", "project_id": "dotted-hulling-477021-d2", "job_id": "dbc56663-5ed8-4334-a5a7-1e564d398645", "slot_ms": 5015}, "message": "CREATE TABLE (100.0 rows, 14.2 KiB processed)", "failures": null, "unique_id": "model.envquery.stg_organizations", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from `dotted-hulling-477021-d2`.`dbt_test_staging`.`organizations-100`  -- \u2190 confirm your seed name!\n),\n\nrenamed as (\n    select\n        -- Surrogate key (handle potential duplicates via composite)\n        to_hex(md5(cast(coalesce(cast(`Organization Id` as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Name as string), '_dbt_utils_surrogate_key_null_') as string))) as organization_sk,\n\n        `Organization Id` as organization_id,\n        trim(initcap(Name)) as org_name,\n        nullif(trim(Website), '') as website,\n        upper(trim(Country)) as country_code,\n        nullif(trim(Description), '') as description,\n\n        -- Safe cast numeric fields \u2014 NO TRIM()\n        safe_cast(Founded as int64) as founded_year,\n        trim(initcap(Industry)) as industry,\n        safe_cast(`Number of employees` as int64) as employee_count,\n\n        -- Metadata\n        current_timestamp() as load_timestamp,\n        'ee6e5a77-04a9-491a-b476-ab30f93ae528' as dbt_invocation_id\n    from source\n)\n\nselect * from renamed", "relation_name": "`dotted-hulling-477021-d2`.`dbt_test_staging`.`orgs`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-12T17:12:47.785216Z", "completed_at": "2025-11-12T17:12:47.865110Z"}, {"name": "execute", "started_at": "2025-11-12T17:12:47.873617Z", "completed_at": "2025-11-12T17:12:52.605346Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.835766792297363, "adapter_response": {"_message": "CREATE TABLE (100.0 rows, 17.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 100, "bytes_processed": 18192, "bytes_billed": 10485760, "location": "EU", "project_id": "dotted-hulling-477021-d2", "job_id": "c93de5d6-16c9-423d-a26a-c578d715c12e", "slot_ms": 4416}, "message": "CREATE TABLE (100.0 rows, 17.8 KiB processed)", "failures": null, "unique_id": "model.envquery.stg_customers", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from `dotted-hulling-477021-d2`.`dbt_test_staging`.`customers_100`\n),\n\nrenamed as (\n    select\n        -- \u2705 Use raw column name (with backticks) in surrogate_key\n        to_hex(md5(cast(coalesce(cast(`Customer Id` as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_sk,\n\n        cast(Index as int64) as customer_index,\n        `Customer Id` as customer_id,\n        trim(initcap(`First Name`)) as first_name,\n        trim(initcap(`Last Name`)) as last_name,\n        nullif(trim(Company), '') as company,\n        trim(initcap(City)) as city,\n        upper(trim(Country)) as country_code,\n        coalesce(\n            nullif(trim(`Phone 1`), ''),\n            nullif(trim(`Phone 2`), '')\n        ) as main_phone,\n        lower(trim(Email)) as email,\n        safe_cast(`Subscription Date` as date) as subscription_date,\n        nullif(trim(Website), '') as website,\n        current_timestamp() as load_timestamp,\n        'ee6e5a77-04a9-491a-b476-ab30f93ae528' as dbt_invocation_id\n    from source\n)\n\nselect * from renamed", "relation_name": "`dotted-hulling-477021-d2`.`dbt_test_staging`.`clients`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-12T17:12:47.866127Z", "completed_at": "2025-11-12T17:12:47.912878Z"}, {"name": "execute", "started_at": "2025-11-12T17:12:47.953838Z", "completed_at": "2025-11-12T17:12:52.622985Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 4.774781703948975, "adapter_response": {"_message": "CREATE TABLE (100.0 rows, 16.3 KiB processed)", "code": "CREATE TABLE", "rows_affected": 100, "bytes_processed": 16648, "bytes_billed": 10485760, "location": "EU", "project_id": "dotted-hulling-477021-d2", "job_id": "e0ef0188-413a-433e-971f-210eb3f6a219", "slot_ms": 2837}, "message": "CREATE TABLE (100.0 rows, 16.3 KiB processed)", "failures": null, "unique_id": "model.envquery.stg_products", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from `dotted-hulling-477021-d2`.`dbt_test_staging`.`products-100`\n),\n\nrenamed as (\n    select\n        -- Surrogate key (hash of business key)\n        to_hex(md5(cast(coalesce(cast(`Internal ID` as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Color as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Size as string), '_dbt_utils_surrogate_key_null_') as string))) as product_sk,\n\n        -- Business key\n        `Internal ID` as product_id,\n\n        -- Clean text fields (\u2705 trim + initcap safe for strings)\n        trim(initcap(cast(Name as string))) as product_name,\n        nullif(trim(cast(Description as string)), '') as description,\n        trim(initcap(cast(Brand as string))) as brand,\n        trim(initcap(cast(Category as string))) as category,\n\n        -- Numeric/monetary (\u2705 safe_cast \u2014 no trim!)\n        safe_cast(Price as numeric) as price,\n        upper(trim(cast(Currency as string))) as currency,\n        safe_cast(Stock as int64) as stock_qty,\n\n        -- Identifiers & attributes (\u2705 trim strings only)\n        nullif(trim(cast(EAN as string)), '') as ean,\n        trim(cast(Color as string)) as color,\n        trim(cast(Size as string)) as size,\n\n        -- Standardized status\n-- Standardize availability_status based on observed raw values\n        case\n        when lower(trim(Availability)) in ('in_stock', 'in stock', 'instock', 'available', 'yes', 'true', '1')\n            then 'In Stock'\n\n        when lower(trim(Availability)) in ('out_of_stock', 'out of stock', 'oos', 'unavailable', 'no', 'false', '0')\n            then 'Out of Stock'\n\n        when lower(trim(Availability)) in ('pre_order', 'preorder', 'pre-order', 'coming soon')\n            then 'Pre-order'\n\n        when lower(trim(Availability)) in ('limited_stock', 'limited stock', 'low stock', 'few left')\n            then 'Limited Stock'\n\n        when lower(trim(Availability)) in ('backorder', 'back order', 'on backorder')\n            then 'Backorder'\n\n        when lower(trim(Availability)) in ('discontinued', 'discontinued.', 'no longer available')\n            then 'Discontinued'\n\n        when coalesce(trim(Availability), '') = '' or Availability is null\n            then 'Unknown'\n\n        else initcap(trim(Availability))\n        end as availability_status,\n        -- Metadata\n        current_timestamp() as load_timestamp,\n        'ee6e5a77-04a9-491a-b476-ab30f93ae528' as dbt_invocation_id\n    from source\n)\n\nselect * from renamed", "relation_name": "`dotted-hulling-477021-d2`.`dbt_test_staging`.`products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-12T17:12:52.652127Z", "completed_at": "2025-11-12T17:12:52.676383Z"}, {"name": "execute", "started_at": "2025-11-12T17:12:52.678383Z", "completed_at": "2025-11-12T17:12:56.996070Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.3567423820495605, "adapter_response": {"_message": "CREATE TABLE (100.0 rows, 18.3 KiB processed)", "code": "CREATE TABLE", "rows_affected": 100, "bytes_processed": 18747, "bytes_billed": 10485760, "location": "EU", "project_id": "dotted-hulling-477021-d2", "job_id": "86b38b41-daec-49c4-a265-e2903d5ed7e8", "slot_ms": 2847}, "message": "CREATE TABLE (100.0 rows, 18.3 KiB processed)", "failures": null, "unique_id": "model.envquery.dim_organizations", "compiled": true, "compiled_code": "\n\nselect\n    organization_sk,\n    organization_id,\n    org_name,\n    website,\n    country_code,\n    description,\n    founded_year,\n    industry,\n    employee_count,\n    load_timestamp\nfrom `dotted-hulling-477021-d2`.`dbt_test_staging`.`orgs`", "relation_name": "`dotted-hulling-477021-d2`.`dbt_test_core`.`dim_organizations`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-12T17:12:52.666861Z", "completed_at": "2025-11-12T17:12:52.686784Z"}, {"name": "execute", "started_at": "2025-11-12T17:12:52.735419Z", "completed_at": "2025-11-12T17:12:57.849815Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.208823919296265, "adapter_response": {"_message": "CREATE TABLE (100.0 rows, 21.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 100, "bytes_processed": 22334, "bytes_billed": 10485760, "location": "EU", "project_id": "dotted-hulling-477021-d2", "job_id": "805a57d7-b533-45b9-9796-5e1c1549da80", "slot_ms": 2204}, "message": "CREATE TABLE (100.0 rows, 21.8 KiB processed)", "failures": null, "unique_id": "model.envquery.dim_products", "compiled": true, "compiled_code": "\n\nselect\n    product_sk,\n    product_id,\n    product_name,\n    description,\n    brand,\n    category,\n    price,\n    currency,\n    stock_qty,\n    ean,\n    color,\n    size,\n    availability_status,\n    load_timestamp\nfrom `dotted-hulling-477021-d2`.`dbt_test_staging`.`products`", "relation_name": "`dotted-hulling-477021-d2`.`dbt_test_core`.`dim_products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-12T17:12:52.658631Z", "completed_at": "2025-11-12T17:12:52.677383Z"}, {"name": "execute", "started_at": "2025-11-12T17:12:52.687783Z", "completed_at": "2025-11-12T17:12:58.399833Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 5.758839130401611, "adapter_response": {"_message": "CREATE TABLE (100.0 rows, 16.9 KiB processed)", "code": "CREATE TABLE", "rows_affected": 100, "bytes_processed": 17259, "bytes_billed": 10485760, "location": "EU", "project_id": "dotted-hulling-477021-d2", "job_id": "44ec8740-4a75-4175-adc9-22a768d1d32d", "slot_ms": 2421}, "message": "CREATE TABLE (100.0 rows, 16.9 KiB processed)", "failures": null, "unique_id": "model.envquery.dim_customers", "compiled": true, "compiled_code": "\n\nselect\n    customer_sk,\n    customer_id,\n    first_name,\n    last_name,\n    coalesce(company, 'Individual') as customer_type,\n    city,\n    country_code,\n    main_phone,\n    email,\n    subscription_date,\n    load_timestamp\nfrom `dotted-hulling-477021-d2`.`dbt_test_staging`.`clients`", "relation_name": "`dotted-hulling-477021-d2`.`dbt_test_core`.`dim_customers`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-12T17:12:58.415383Z", "completed_at": "2025-11-12T17:12:58.427925Z"}, {"name": "execute", "started_at": "2025-11-12T17:12:58.429050Z", "completed_at": "2025-11-12T17:13:04.611420Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 6.202024221420288, "adapter_response": {"_message": "CREATE TABLE (753.0 rows, 17.1 KiB processed)", "code": "CREATE TABLE", "rows_affected": 753, "bytes_processed": 17474, "bytes_billed": 31457280, "location": "EU", "project_id": "dotted-hulling-477021-d2", "job_id": "f568e5a5-36ec-44e6-8157-5222f0413c51", "slot_ms": 13714}, "message": "CREATE TABLE (753.0 rows, 17.1 KiB processed)", "failures": null, "unique_id": "model.envquery.fct_orders", "compiled": true, "compiled_code": "\n\nwith base_combos as (\n    select\n        c.customer_sk,\n        p.product_sk,\n        o.organization_sk,\n        c.subscription_date,\n        p.price\n    from `dotted-hulling-477021-d2`.`dbt_test_core`.`dim_customers` c\n    cross join `dotted-hulling-477021-d2`.`dbt_test_core`.`dim_products` p\n    left join `dotted-hulling-477021-d2`.`dbt_test_core`.`dim_organizations` o\n        on c.customer_type != 'Individual' \n        and lower(trim(c.customer_type)) = lower(trim(o.org_name))\n    where c.subscription_date is not null\n      and p.price > 0\n      and p.availability_status in ('In Stock', 'Limited Stock')\n),\n\n-- \u2705 Deterministic sampling: use HASH of keys instead of RAND()\nsampled as (\n    select *,\n        -- Hash-based sampling: ~20% of rows (mod 5 = 0 \u2192 ~20%)\n        mod(abs(farm_fingerprint(concat(customer_sk, product_sk))), 5) as bucket\n    from base_combos\n)\n\nselect\n    to_hex(md5(cast(coalesce(cast(customer_sk as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_sk as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(subscription_date as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(bucket as string), '_dbt_utils_surrogate_key_null_') as string))) as order_item_key,\n\n    customer_sk,\n    product_sk,\n    organization_sk,\n\n    -- Generate order date within 1 year of subscription\n    date_add(\n        subscription_date,\n        interval cast(floor(bucket * 73) as int64) day  -- spread over 365 days\n    ) as order_date,\n\n    1 + mod(bucket, 3) as quantity,  -- 1\u20133 items\n    price * (1 + mod(bucket, 3)) as amount,\n\n    current_timestamp() as load_timestamp\n\nfrom sampled\nwhere bucket = 0  -- \u2705 Deterministic: exactly ~20% of rows", "relation_name": "`dotted-hulling-477021-d2`.`dbt_test_core`.`fct_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-12T17:13:04.620423Z", "completed_at": "2025-11-12T17:13:04.626422Z"}, {"name": "execute", "started_at": "2025-11-12T17:13:04.626422Z", "completed_at": "2025-11-12T17:13:09.327437Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.712919235229492, "adapter_response": {"_message": "CREATE TABLE (100.0 rows, 53.7 KiB processed)", "code": "CREATE TABLE", "rows_affected": 100, "bytes_processed": 54997, "bytes_billed": 20971520, "location": "EU", "project_id": "dotted-hulling-477021-d2", "job_id": "60ce8fb8-527c-40fc-9625-d29a47747ae8", "slot_ms": 2770}, "message": "CREATE TABLE (100.0 rows, 53.7 KiB processed)", "failures": null, "unique_id": "model.envquery.monthly_revenue_by_customer_type", "compiled": true, "compiled_code": "\n\nselect\n    date_trunc(order_date, month) as order_month,\n    c.customer_type,\n    count(distinct f.customer_sk) as active_customers,\n    sum(f.quantity) as total_items_sold,\n    sum(f.amount) as total_revenue\n\nfrom `dotted-hulling-477021-d2`.`dbt_test_core`.`fct_orders` f\njoin `dotted-hulling-477021-d2`.`dbt_test_core`.`dim_customers` c\n    on f.customer_sk = c.customer_sk\n\ngroup by 1, 2", "relation_name": "`dotted-hulling-477021-d2`.`dbt_test_marts_sales`.`monthly_revenue_by_customer_type`", "batch_results": null}], "elapsed_time": 27.91150164604187, "args": {"introspect": true, "log_file_max_bytes": 10485760, "profiles_dir": "C:\\Users\\eki\\Desktop\\fsg", "which": "run", "log_format_file": "debug", "write_json": true, "exclude": [], "log_level": "info", "macro_debugging": false, "use_colors_file": true, "favor_state": false, "show_resource_report": false, "select": ["+monthly_revenue_by_customer_type"], "require_resource_names_without_spaces": true, "use_fast_test_edges": false, "project_dir": "C:\\Users\\eki\\Desktop\\fsg", "cache_selected_only": false, "log_path": "C:\\Users\\eki\\Desktop\\fsg\\logs", "require_nested_cumulative_type_params": false, "indirect_selection": "eager", "printer_width": 80, "defer": false, "require_batched_execution_for_custom_microbatch_strategy": false, "strict_mode": false, "version_check": true, "vars": {}, "state_modified_compare_more_unrendered_values": false, "print": true, "upload_to_artifacts_ingest_api": false, "empty": false, "invocation_command": "dbt run -s +monthly_revenue_by_customer_type", "partial_parse_file_diff": true, "state_modified_compare_vars": false, "log_format": "default", "require_all_warnings_handled_by_warn_error": false, "require_yaml_configuration_for_mf_time_spines": false, "log_level_file": "debug", "source_freshness_run_project_hooks": true, "partial_parse": true, "show_all_deprecations": false, "use_colors": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "quiet": false, "skip_nodes_if_on_run_start_fails": false, "populate_cache": true, "require_explicit_package_overrides_for_builtin_materializations": true, "static_parser": true, "send_anonymous_usage_stats": true, "validate_macro_args": false, "require_generic_test_arguments_property": true}}